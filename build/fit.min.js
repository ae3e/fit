var fit=function(t){"use strict";function e(t){var e={};return t&&t.length>0&&(e.min=Math.min.apply(null,t.filter(function(t){return null!=t})),e.max=Math.max.apply(null,t.filter(function(t){return null!=t})),e.sum=t.reduce(function(t,e){return t+e}),e.mean=e.sum/t.length),e}function a(t){return{name:t,type:0,coordinates:{},times:{},durations:{},distances:{},parameters:{},intervals:{},calculateDurations:function(){if(this.times){var t=[];this.times.data.forEach(function(e,a,s){t.push(new Date(e)-new Date(s[0]))}),this.durations={name:"Durations",data:t,statistics:e(t)}}},calculateDistances:function(){var t=function(t,e,a,s){var i=6372.8,n=(a-t)*(Math.PI/180),r=(s-e)*(Math.PI/180);t*=Math.PI/180,a*=Math.PI/180;var c=Math.sin(n/2)*Math.sin(n/2)+Math.sin(r/2)*Math.sin(r/2)*Math.cos(t)*Math.cos(a),u=2*Math.asin(Math.sqrt(c));return i*u},e=[];this.coordinates.forEach(function(a,s,i){s>0?e.push(e[s-1]+t(i[s-1][1],i[s-1][0],i[s][1],i[s][0])):e.push(0)}),this.distances={name:"Distances",data:e}},calculateSpeeds:function(){var t=this.distances.data,a=this.times.data;if(a&&t){var s=[];a.forEach(function(e,i,n){if(0==i)s.push(null);else{var r=(t[i]-t[i-1])/(new Date(a[i])-new Date(a[i-1]))*1e3*60*60;(isNaN(r)||!isFinite(r))&&(r=null),s.push(r)}}),this.speeds={name:"Speeds",data:s,statistics:e(s)}}},fromGeoJSON:function(t){if(t.features[0].geometry.coordinates&&(this.coordinates=t.features[0].geometry.coordinates,this.calculateDistances(),this.coordinates[0][2])){var a=[];t.features[0].geometry.coordinates.forEach(function(t,e,s){a.push(t[2])}),this.altitudes={name:"Altitudes",data:a,statistics:e(a)}}t.features[0].properties.times&&(this.times={name:"Times",data:t.features[0].properties.times},this.calculateDurations()),this.distances&&this.times&&this.calculateSpeeds(),t.features[0].properties.heartrates&&(this.heartrates={name:"Heartrates",data:t.features[0].properties.heartrates,statistics:e(t.features[0].properties.heartrates)}),t.features[0].properties.cadences&&(this.cadences={name:"Cadences",data:t.features[0].properties.cadences,statistics:e(t.features[0].properties.cadences)})}}}function s(t,e){return t+e}return t.sum=s,t.createSession=a,t}({});